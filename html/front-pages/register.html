<!DOCTYPE html>
<html lang="en" class="layout-navbar-fixed layout-wide" dir="ltr" data-assets-path="../../assets/" data-template="front-pages" data-bs-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Sign up | TemaDigital Data Portal</title>
  <link rel="icon" type="image/x-icon" href="../../assets/img/favicon/favicon.ico">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&amp;display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/vendor/fonts/iconify-icons.css">
  <link rel="stylesheet" href="../../assets/vendor/css/core.css">
  <link rel="stylesheet" href="../../assets/css/demo.css">
  <link rel="stylesheet" href="../../assets/vendor/css/pages/front-page.css">
  <script src="../../assets/vendor/js/helpers.js"></script>
  <script src="../../assets/js/front-config.js"></script>
  <style>
    .btn-google { background-color: #fff; color: #3c4043; border: 1px solid #dadce0; }
    .btn-google:hover { background-color: #f8f9fa; border-color: #dadce0; color: #3c4043; }
    .btn-facebook { background-color: #1877f2; color: #fff; border: none; }
    .btn-facebook:hover { background-color: #166fe5; color: #fff; }
    .btn-social { display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; padding: 0.625rem 1.25rem; font-weight: 500; }
  </style>
</head>
<body class="min-vh-100 d-flex flex-column">
  <nav class="layout-navbar shadow-none py-0">
    <div class="container">
      <div class="navbar navbar-expand-lg landing-navbar px-3">
        <a href="landing-page.html" class="app-brand-link d-flex align-items-center">
          <span class="app-brand-logo demo">
            <img src="../../assets/img/front-pages/landing-page/temadigital_logo.png" alt="TemaDigital" style="height: 40px; display: block;">
          </span>
          <span class="app-brand-text demo menu-text fw-bold ms-2 ps-1">Temadigital</span>
        </a>
        <div class="ms-auto">
          <a href="landing-page.html" class="btn btn-outline-primary btn-sm">Back to Home</a>
        </div>
      </div>
    </div>
  </nav>

  <div class="flex-grow-1 d-flex align-items-center">
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-md-6 col-lg-5">
        <div class="card shadow">
          <div class="card-body p-4 p-sm-5">
            <div class="text-center mb-5">
              <h4 class="mb-2">Create your account</h4>
              <p class="text-body small mb-0">Use Google/Facebook or sign up with email and a password.</p>
            </div>

            <div class="d-grid gap-3">
              <a href="#" id="btnGoogle" class="btn btn-google btn-social">
                <i class="bx bxl-google icon-base" style="font-size: 1.25rem;"></i>
                Sign up with Google
              </a>
              <a href="#" id="btnFacebook" class="btn btn-facebook btn-social">
                <i class="bx bxl-facebook icon-base" style="font-size: 1.25rem;"></i>
                Sign up with Facebook
              </a>
            </div>

            <p class="small text-body text-center mt-4 mb-2">— or sign up with email —</p>
            <form id="registerForm" novalidate>
              <div class="mb-3">
                <label class="form-label" for="regEmail">Email <span class="text-danger">*</span></label>
                <input type="email" class="form-control" id="regEmail" name="email" placeholder="your@email.com" autocomplete="email">
                <div class="invalid-feedback">Please enter a valid email.</div>
              </div>
              <div class="mb-3">
                <label class="form-label" for="regPassword">Password <span class="text-danger">*</span></label>
                <input type="password" class="form-control" id="regPassword" name="password" placeholder="At least 6 characters" autocomplete="new-password">
                <div class="invalid-feedback">Password must be at least 6 characters.</div>
              </div>
              <div class="mb-3">
                <label class="form-label" for="regConfirm">Confirm password <span class="text-danger">*</span></label>
                <input type="password" class="form-control" id="regConfirm" name="confirm" placeholder="Repeat password" autocomplete="new-password">
                <div class="invalid-feedback">Passwords do not match.</div>
              </div>
              <div class="d-grid gap-2 mt-3">
                <button type="submit" class="btn btn-outline-primary">Sign up with email</button>
              </div>
              <p id="registerMessage" class="small mt-2 mb-0 text-center"></p>
            </form>

            <p class="small text-body text-center mt-4 mb-0">
              By signing up, you agree to our <a href="#" class="text-primary">Terms of Service</a> and <a href="#" class="text-primary">Privacy Policy</a>.
            </p>

            <hr class="my-4">
            <div class="text-center small">
              Already have an account? <a href="login.html" class="fw-medium">Log in</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>

  <script src="../../assets/vendor/libs/jquery/jquery.js"></script>
  <script src="../../assets/vendor/libs/popper/popper.js"></script>
  <script src="../../assets/vendor/js/bootstrap.js"></script>
  <script>
    var AUTH_GOOGLE_URL = 'http://localhost:3000/api/auth/google';
    var AUTH_FACEBOOK_URL = 'http://localhost:3000/api/auth/facebook';
    var AUTH_API = 'http://localhost:3000';

    document.getElementById('btnGoogle').addEventListener('click', function (e) {
      if (AUTH_GOOGLE_URL) { this.href = AUTH_GOOGLE_URL; return; }
      e.preventDefault();
      alert('Google sign-up: Set AUTH_GOOGLE_URL and run the auth-server.');
    });
    document.getElementById('btnFacebook').addEventListener('click', function (e) {
      if (AUTH_FACEBOOK_URL) { this.href = AUTH_FACEBOOK_URL; return; }
      e.preventDefault();
      alert('Facebook sign-up: Set AUTH_FACEBOOK_URL and run the auth-server.');
    });

    document.getElementById('registerForm').addEventListener('submit', function (e) {
      e.preventDefault();
      var email = document.getElementById('regEmail');
      var password = document.getElementById('regPassword');
      var confirm = document.getElementById('regConfirm');
      var msg = document.getElementById('registerMessage');
      msg.textContent = '';
      msg.className = 'small mt-2 mb-0 text-center';
      var ok = true;
      email.classList.toggle('is-invalid', !email.value.trim());
      if (!email.value.trim()) ok = false;
      password.classList.toggle('is-invalid', password.value.length < 6);
      if (password.value.length < 6) ok = false;
      confirm.classList.toggle('is-invalid', password.value !== confirm.value);
      if (password.value !== confirm.value) ok = false;
      if (!ok) return;
      var btn = this.querySelector('button[type="submit"]');
      btn.disabled = true;
      fetch(AUTH_API + '/api/auth/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email: email.value.trim(), password: password.value }),
        credentials: 'include'
      })
        .then(function (r) { return r.json().then(function (j) { return { status: r.status, body: j }; }); })
        .then(function (x) {
          if (x.body.success) {
            msg.className = 'small mt-2 mb-0 text-center text-success';
            msg.textContent = 'Account created. Redirecting to login…';
            setTimeout(function () { window.location.href = 'login.html'; }, 1500);
          } else {
            msg.className = 'small mt-2 mb-0 text-center text-danger';
            msg.textContent = x.body.message || 'Registration failed.';
            btn.disabled = false;
          }
        })
        .catch(function () {
          msg.className = 'small mt-2 mb-0 text-center text-danger';
          msg.textContent = 'Cannot reach server. Is the auth server running (npm start)?';
          btn.disabled = false;
        });
    });
  </script>
</body>
</html>
